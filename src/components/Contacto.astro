<script is:inline>
  const form = document.getElementById('contact-form');
  form?.addEventListener('submit', async (e) => {
    e.preventDefault();
    const fd = new FormData(form);
    const payload = {
      name: fd.get('name'),
      email: fd.get('email'),
      message: fd.get('message'),
    };

    const btn = form.querySelector('button[type="submit"]');
    const original = btn.textContent;
    btn.disabled = true; btn.textContent = 'Enviando…';

    try {
      const r = await fetch('/api/contact', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(payload),
      });
      const data = await r.json().catch(() => ({}));
      if (!r.ok || !data.ok) throw new Error(data.error || `HTTP ${r.status}`);
      alert('¡Gracias! Te vamos a escribir :)');
      form.reset();
    } catch (err) {
      console.error('contact error', err);
      alert(`Uy, no se pudo enviar: ${err.message}`);
    } finally {
      btn.disabled = false; btn.textContent = original;
    }
  });
</script>

<section id="contacto" class="section contact">
  <div class="container">
    <!-- Título igual al de “Nuestra historia” / “Revistas” -->
    <h2
      class="section-title"
      style="
        --st-size: clamp(36px, 7vw, 88px);
        --st-letter: .08em;
        --st-tx: 0px;
        --st-ty: 0px;
      "
    >
      Contacto
    </h2>

    <div class="panel">
      <form id="contact-form" novalidate>
        <!-- Nombre + Email (2 columnas en desktop) -->
        <div class="two-col">
          <div class="field">
            <label for="name">Nombre</label>
            <input id="name" name="name" type="text" placeholder="Tu nombre" required />
          </div>

          <div class="field">
            <label for="email">Email</label>
            <input id="email" name="email" type="email" placeholder="Tu correo" required />
          </div>
        </div>

        <!-- Mensaje -->
        <div class="field">
          <label for="message">Mensaje</label>
          <textarea
            id="message"
            name="message"
            placeholder="Contanos tu consulta"
            rows="6"
            required
          ></textarea>
        </div>

        <!-- Acción -->
        <div class="actions">
          <button type="submit" class="btn-primary">Enviar</button>
        </div>
      </form>
    </div>
  </div>

  <!-- Estilos locales (sólo pulen la presentación del form) -->
  <style>
    .field label{
      display:block;
      margin: 0 0 8px;
      font-size:12px;
      font-weight:900;
      letter-spacing:.14em;
      text-transform:uppercase;
      color: var(--muted);
    }

    .actions{
      display:flex;
      justify-content:flex-end;
      margin-top: 6px;
    }

    /* Un poco más de aire en inputs */
    #contact-form .two-col { margin-bottom: 8px; }

    /* Mobile: botón ancho completo */
    @media (max-width: 560px){
      .actions .btn-primary{
        width:100%;
        text-align:center;
      }
    }
  </style>
</section>
